{% extends 'base.html' %} {% block content %}

<h2>ğŸ“Š Dashboard</h2>
{% if user.role == 'admin' %}
  <form method="get">
    <label for="shop">Select Shop:</label>
    <select name="shop" id="shop" onchange="this.form.submit()">
      <option value="">-- All Shops --</option>
      {% for shop in available_shops %}
        <option value="{{ shop.id }}" {% if shop.id == selected_shop.id %}selected{% endif %}>
          {{ shop.name }}
        </option>
      {% endfor %}
    </select>
  </form>
{% else %}
  <p>ğŸ›ï¸ Shop: {{ selected_shop.name }}</p>
{% endif %}

<div style="display: flex; flex-wrap: wrap; gap: 20px">
  <div style="border: 1px solid #ccc; padding: 20px; width: 200px">
    <h3>ğŸ’° Sales Today</h3>
    <p>GHC {{ total_sales_today }}</p>
    <a href="{% url 'sales:sales_list' %}">View Details</a>
  </div>

  <div style="border: 1px solid #ccc; padding: 20px; width: 200px">
    <h3>ğŸ’³ Outstanding Credits</h3>
    <p>{{ total_credits }}</p>
    <a href="{% url 'sales:credit_list' %}">View Details</a>
  </div>

  <div style="border: 1px solid #ccc; padding: 20px; width: 200px">
    <h3>ğŸ“¦ Total Items</h3>
    <p>{{ total_inventory_items }}</p>
    <a href="{% url 'item_list' %}">View Inventory</a>
  </div>

  <div style="border: 1px solid #f55; padding: 20px; width: 200px">
    <h3 style="color: red">âš ï¸ Low Stock</h3>
    <p>{{ low_stock_count }}</p>
    <a href="{% url 'low_stock_list' %}">View Items</a>
  </div>
</div>
{% if user.role == 'admin' or user.role == "manager" %}
<h3>ğŸ“¤ Export Data</h3>
<ul>
  <li><a href="{% url 'sales:export_sales_csv' %}">Download Sales CSV</a></li>
  <li>
    <a href="{% url 'sales:export_credits_csv' %}">Download Credits CSV</a>
  </li>
  <li>
    <a href="{% url 'sales:export_inventory_csv' %}">Download Inventory CSV</a>
  </li>
</ul>
{% endif%} {% endblock %}
